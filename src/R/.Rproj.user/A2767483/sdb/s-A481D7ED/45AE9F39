{
    "contents" : "\napiUrl <- \"http://www.tycho.pitt.edu/api/\"\nqueryUrl <- paste(apiUrl, \"query?\", sep=\"\")\ninfoUrl <- paste(apiUrl, \"info?\", sep=\"\")\n\n# Add the api key to the given url. Optionally specify the format for the returned data (xml, txt, csv)\naddApiKey <- function(url, key, format=\"csv\") {\n   paste(url, \"apikey=\", key, \".\", format, sep=\"\")\n}\n\n# read a list of available data (like diseases, cities and states)\nreadList <- function (u) {\n   url <- paste(apiUrl, u, \"?\", sep=\"\")\n   url <- addApiKey(url, tychoApiKey)\n   read.csv(url, stringsAsFactors=FALSE)\n}\n\n# build the URL for a query\nquery <- function (apikey, disease, state, event=\"cases\", loc_type=\"state\", city, start, end, format=\"csv\") {\n   if (missing(apikey))\n      stop(\"apikey must be provided!\")\n   if (missing(disease))\n      stop(\"disease must be provided!\")\n   if (missing(state))\n      stop(\"state must be provided!\")\n   if (!(loc_type %in% c(\"city\", \"state\")))\n      stop(\"loc_type must be either \\\"city\\\" or \\\"state\\\"\")\n   if (loc_type==\"city\" && missing(city))\n      stop(\"A city must be specified when using loc_type=city\")\n   \n   url <- paste(queryUrl, \"event=\", event, \"&loc_type=\", loc_type, \"&disease=\", URLencode(disease),\n                \"&state=\", state, sep=\"\")\n   \n   if (!missing(city))\n      url <- paste(url, \"&city=\", URLencode(city), sep=\"\")\n   \n   if (!missing(start))\n      url <- paste(url, \"&start=\", URLencode(start), sep=\"\")\n   \n   if (!missing(end))\n      url <- paste(url, \"&end=\", URLencode(end), sep=\"\")\n   \n   url <- paste(url, \"&\", sep=\"\")\n   \n   addApiKey(url, apikey, format)\n}\n\n# build the URL for an info\ninfo <- function(apikey, loc_type=\"state\", event=\"cases\", state, disease, loc, format=\"csv\") {\n   if (missing(apikey))\n      stop(\"apikey must be provided!\")\n   if (missing(disease) && missing(loc))\n      stop(\"must provide either disease or loc\")\n\n   url <- paste(infoUrl, \"event=\", event, \"&loc_type=\", loc_type, sep=\"\")\n   \n   if (!missing(disease))\n      url <- paste(url, \"&disease=\", URLencode(disease), sep=\"\")\n   \n   if (!missing(state))\n      url <- paste(url, \"&state=\", state, sep=\"\")\n   \n   if (!missing(loc))\n      url <- paste(url, \"&loc\", loc, sep=\"\")\n   \n   url <- paste(url, \"&\", sep=\"\")\n   \n   addApiKey(url, apikey, format)\n}\n\n\n",
    "created" : 1389145973748.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1211244613",
    "id" : "45AE9F39",
    "lastKnownWriteTime" : 1389319315,
    "path" : "~/src/web-app-explore/src/R/tycho.R",
    "project_path" : "tycho.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}